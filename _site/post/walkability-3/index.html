<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="dcterms.date" content="2020-12-08">
<meta name="description" content="Part 3: Checking network results with APIs and visualising walkability isochrones.">

<title>Shrividya Ravi - Walking in Wellington - validation and visualisation</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Shrividya Ravi</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html" rel="" target="">
 <span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../projects.html" rel="" target="">
 <span class="menu-text">Projects</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../articles.html" rel="" target="">
 <span class="menu-text">Articles</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../blog.html" rel="" target="">
 <span class="menu-text">Technical blog</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../talks.html" rel="" target="">
 <span class="menu-text">Presentations</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/shriv" rel="" target=""><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/ShrividyaRavi" rel="" target=""><i class="bi bi-twitter" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction">Introduction</a></li>
  <li><a href="#validating-the-accessibility-analysis" id="toc-validating-the-accessibility-analysis" class="nav-link" data-scroll-target="#validating-the-accessibility-analysis">Validating the accessibility analysis</a>
  <ul class="collapse">
  <li><a href="#with-google-maps" id="toc-with-google-maps" class="nav-link" data-scroll-target="#with-google-maps">With Google Maps</a></li>
  <li><a href="#with-graphhopper-routing-api" id="toc-with-graphhopper-routing-api" class="nav-link" data-scroll-target="#with-graphhopper-routing-api">With Graphhopper Routing API</a></li>
  </ul></li>
  <li><a href="#inverting-accessibility-to-isochrones" id="toc-inverting-accessibility-to-isochrones" class="nav-link" data-scroll-target="#inverting-accessibility-to-isochrones">Inverting accessibility to isochrones</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Walking in Wellington - validation and visualisation</h1>
  <div class="quarto-categories">
    <div class="quarto-category">data science</div>
    <div class="quarto-category">walkability</div>
    <div class="quarto-category">transport</div>
    <div class="quarto-category">new zealand</div>
    <div class="quarto-category">network analysis</div>
  </div>
  </div>

<div>
  <div class="description">
    Part 3: Checking network results with APIs and visualising walkability isochrones.
  </div>
</div>


<div class="quarto-title-meta">

    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">December 8, 2020</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<p>The OSM network has useful metadata that is consumed by <code>pandana</code> to calculate access to playgrounds and thus local walkbility. If these metrics are to be used for formal appraisals or evaluations, it is useful to check against commonly used routing APIs. Here, we look at Google Maps and GraphHopper but <a href="https://www.targomo.com/developers/apis/isochrone/">Targomo</a> is also a great option - especially if the isochrone polygons are the desired output. In this post, isochrones will be constructed <em>after</em> the accesibility calculation using some nifty features of <code>networkx</code>.</p>
</section>
<section id="validating-the-accessibility-analysis" class="level2">
<h2 class="anchored" data-anchor-id="validating-the-accessibility-analysis">Validating the accessibility analysis</h2>
<p>We’ve see how Wellington’s topography affects travel times to playgrounds. A quick validation of the approach can be done with Google Maps. A more complex validation can be done Graphhopper.</p>
<p>We’ll be validating the route from 110 John Sims Drive to Kipling Street Play Area. I chose this particular example because of the monotonicity in gradient for the to and from journeys. Going to the park is consistently downhill and coming back is consistently uphill. None of the classic Wellington roller-coaster routes here!</p>
<p>The route used to calculate the accessibility in <em>pandana</em> can be visualised by extracting the nearest graph nodes to the origin and destination and using the Networkx get_shortest_path method.</p>
<p>With a little additional poking about the graph edges, we can extract the summary, in distance and time, for this route. The code for this is available in the Jupyter Notebook.</p>
<blockquote class="blockquote">
<p>Route is 925 m long and takes 24.3 mins</p>
</blockquote>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="output_54_0.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">png</figcaption>
</figure>
</div>
<p>A more detailed analysis of the route gives:</p>
<blockquote class="blockquote">
<p>110 John Sims Drive to Kipling Street Play Area: Street distance is 925 m. At 5km/hr, it takes 11.1 mins. Going to the park (downhill) takes 11.9 mins. Coming back from the park (uphill) takes 12.3 mins’</p>
</blockquote>
<section id="with-google-maps" class="level3">
<h3 class="anchored" data-anchor-id="with-google-maps">With Google Maps</h3>
<p><a href="https://www.openstreetmap.org/node/6083853567">110 John Sims Drive</a> to Kipling St Play Area in Johnsonville. - <a href="https://www.google.co.nz/maps/dir/Kipling+Street+Play+Area,+Johnsonville,+Wellington/110+John+Sims+Dr,+Johnsonville,+Wellington+6037/@-41.2287819,174.7921861,15.94z/data=!4m14!4m13!1m5!1m1!1s0x6d38adc0eacfab81:0xb46b5857955895d8!2m2!1d174.797878!2d-41.2251416!1m5!1m1!1s0x6d38ade99a925aa1:0x68fba1d12c2d8b01!2m2!1d174.7921832!2d-41.229301!3e2">Uphill from the park</a>: 14 minutes - <a href="https://www.google.co.nz/maps/dir/110+John+Sims+Dr,+Johnsonville,+Wellington+6037/Kipling+Street+Play+Area,+Johnsonville,+Wellington/@-41.2287819,174.7921861,15.94z/data=!3m1!4b1!4m14!4m13!1m5!1m1!1s0x6d38ade99a925aa1:0x68fba1d12c2d8b01!2m2!1d174.7921832!2d-41.229301!1m5!1m1!1s0x6d38adc0eacfab81:0xb46b5857955895d8!2m2!1d174.797878!2d-41.2251416!3e2">Downhill to the park</a>: 11 minutes</p>
<p>We don’t expect the OSM street data to differ much from Google (at least for a city!) and the elevation data should be identical. The key difference is likely the distance to time conversion. For this validation, we have over-estimated the downhill time and under-estimated the uphill time.</p>
<p>obler’s time conversion is definitely an ambitious target - especially for families walking with young children. For a more accurate analysis, we’d need recommendations of a more sensible top speed and hill climbing speed retardation from Urban Planners.</p>
</section>
<section id="with-graphhopper-routing-api" class="level3">
<h3 class="anchored" data-anchor-id="with-graphhopper-routing-api">With Graphhopper Routing API</h3>
<p>Graphhopper is a powerful engine with a fantastic routing API. It’s easy to <a href="https://www.graphhopper.com/pricing/">register for a free licence</a> and get an API key. Since I’m only using the API for validation, I can stay well within the free limit.</p>
<p>Results from the API request can be visualised both on Graphhopper Maps and OpenStreetMap directions.</p>
<ul>
<li><p>Downhill route visualised <a href="https://www.openstreetmap.org/directions?engine=graphhopper_foot&amp;route=-41.2292%2C174.7922%3B-41.2253%2C174.7976#map=17/-41.22708/174.79538">here</a> and <a href="https://graphhopper.com/maps/?point=-41.2292%2C174.79216&amp;point=-41.22527%2C174.79759&amp;locale=en-us&amp;vehicle=foot&amp;weighting=fastest&amp;elevation=true&amp;use_miles=false&amp;layer=Omniscale">here</a></p></li>
<li><p>Uphill route visualised <a href="https://www.openstreetmap.org/directions?engine=graphhopper_foot&amp;route=-41.22527%2C174.79759%3B-41.22920%2C174.79216">here</a> and <a href="https://graphhopper.com/maps/?point=-41.22527%2C174.79759&amp;point=-41.2292%2C174.79216&amp;locale=en-us&amp;vehicle=foot&amp;weighting=fastest&amp;elevation=true&amp;use_miles=false&amp;layer=Omniscale">here</a></p></li>
</ul>
<p>Crafting the API request is quite simple - the request parameters are detailed <a href="https://github.com/graphhopper/graphhopper/blob/0.11/docs/web/api-doc.md">here</a>. The resultant JSON can be parsed and used for further analysis.</p>
<p>I haven’t quite figured out how to ingest this stream of rich data for further analysis. In theory, I’d like to be able to validate the speeds and times of segments in the route against the <em>pandana</em> + <em>osmnx</em> extract. Perhaps even reverse engineer the gradient to speed conversion.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>graph_hopper_api_key <span class="op">=</span> data_loaded[<span class="st">'graph_hopper_api_key'</span>][<span class="dv">0</span>]</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>graph_hopper_query <span class="op">=</span> <span class="st">"https://graphhopper.com/api/1/route?point=-41.2292,174.7922&amp;point=-41.2253,174.7976&amp;vehicle=foot&amp;points_encoded=false&amp;locale=nz&amp;key="</span> <span class="op">+</span> graph_hopper_api_key</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode" id="cb2"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="ex">%%bash</span> <span class="at">-s</span> <span class="st">"</span><span class="va">$graph_hopper_query</span><span class="st">"</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="ex">curl</span> <span class="va">$1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode" id="cb3"><pre class="sourceCode json code-with-copy"><code class="sourceCode json"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span><span class="dt">"hints"</span><span class="fu">:{</span><span class="dt">"visited_nodes.average"</span><span class="fu">:</span><span class="st">"28.0"</span><span class="fu">,</span><span class="dt">"visited_nodes.sum"</span><span class="fu">:</span><span class="st">"28"</span><span class="fu">},</span><span class="dt">"info"</span><span class="fu">:{</span><span class="dt">"copyrights"</span><span class="fu">:</span><span class="ot">[</span><span class="st">"GraphHopper"</span><span class="ot">,</span><span class="st">"OpenStreetMap contributors"</span><span class="ot">]</span><span class="fu">,</span><span class="dt">"took"</span><span class="fu">:</span><span class="dv">4</span><span class="fu">},</span><span class="dt">"paths"</span><span class="fu">:</span><span class="ot">[</span><span class="fu">{</span><span class="dt">"distance"</span><span class="fu">:</span><span class="fl">1007.3</span><span class="fu">,</span><span class="dt">"weight"</span><span class="fu">:</span><span class="fl">603.101372</span><span class="fu">,</span><span class="dt">"time"</span><span class="fu">:</span><span class="dv">725253</span><span class="fu">,</span><span class="dt">"transfers"</span><span class="fu">:</span><span class="dv">0</span><span class="fu">,</span><span class="dt">"points_encoded"</span><span class="fu">:</span><span class="kw">false</span><span class="fu">,</span><span class="dt">"bbox"</span><span class="fu">:</span><span class="ot">[</span><span class="fl">174.792028</span><span class="ot">,</span><span class="fl">-41.229148</span><span class="ot">,</span><span class="fl">174.798734</span><span class="ot">,</span><span class="fl">-41.22499</span><span class="ot">]</span><span class="fu">,</span><span class="dt">"points"</span><span class="fu">:{</span><span class="dt">"type"</span><span class="fu">:</span><span class="st">"LineString"</span><span class="fu">,</span><span class="dt">"coordinates"</span><span class="fu">:</span><span class="ot">[[</span><span class="fl">174.792028</span><span class="ot">,</span><span class="fl">-41.229148</span><span class="ot">],[</span><span class="fl">174.792089</span><span class="ot">,</span><span class="fl">-41.229032</span><span class="ot">],[</span><span class="fl">174.792403</span><span class="ot">,</span><span class="fl">-41.228742</span><span class="ot">],[</span><span class="fl">174.792854</span><span class="ot">,</span><span class="fl">-41.228362</span><span class="ot">],[</span><span class="fl">174.792949</span><span class="ot">,</span><span class="fl">-41.228113</span><span class="ot">],[</span><span class="fl">174.792882</span><span class="ot">,</span><span class="fl">-41.22792</span><span class="ot">],[</span><span class="fl">174.793009</span><span class="ot">,</span><span class="fl">-41.227871</span><span class="ot">],[</span><span class="fl">174.793469</span><span class="ot">,</span><span class="fl">-41.227519</span><span class="ot">],[</span><span class="fl">174.79382</span><span class="ot">,</span><span class="fl">-41.227449</span><span class="ot">],[</span><span class="fl">174.79396</span><span class="ot">,</span><span class="fl">-41.227773</span><span class="ot">],[</span><span class="fl">174.794037</span><span class="ot">,</span><span class="fl">-41.227829</span><span class="ot">],[</span><span class="fl">174.794583</span><span class="ot">,</span><span class="fl">-41.228031</span><span class="ot">],[</span><span class="fl">174.795135</span><span class="ot">,</span><span class="fl">-41.228387</span><span class="ot">],[</span><span class="fl">174.79614</span><span class="ot">,</span><span class="fl">-41.227492</span><span class="ot">],[</span><span class="fl">174.797424</span><span class="ot">,</span><span class="fl">-41.226418</span><span class="ot">],[</span><span class="fl">174.797595</span><span class="ot">,</span><span class="fl">-41.226301</span><span class="ot">],[</span><span class="fl">174.79831</span><span class="ot">,</span><span class="fl">-41.225888</span><span class="ot">],[</span><span class="fl">174.79852</span><span class="ot">,</span><span class="fl">-41.22564</span><span class="ot">],[</span><span class="fl">174.798734</span><span class="ot">,</span><span class="fl">-41.225427</span><span class="ot">],[</span><span class="fl">174.798559</span><span class="ot">,</span><span class="fl">-41.225274</span><span class="ot">],[</span><span class="fl">174.798037</span><span class="ot">,</span><span class="fl">-41.225018</span><span class="ot">],[</span><span class="fl">174.797925</span><span class="ot">,</span><span class="fl">-41.22499</span><span class="ot">],[</span><span class="fl">174.797878</span><span class="ot">,</span><span class="fl">-41.224999</span><span class="ot">],[</span><span class="fl">174.797832</span><span class="ot">,</span><span class="fl">-41.225054</span><span class="ot">],[</span><span class="fl">174.797679</span><span class="ot">,</span><span class="fl">-41.225337</span><span class="ot">],[</span><span class="fl">174.797637</span><span class="ot">,</span><span class="fl">-41.225354</span><span class="ot">]]</span><span class="fu">},</span><span class="dt">"instructions"</span><span class="fu">:</span><span class="ot">[</span><span class="fu">{</span><span class="dt">"distance"</span><span class="fu">:</span><span class="fl">163.218</span><span class="fu">,</span><span class="dt">"heading"</span><span class="fu">:</span><span class="fl">21.8</span><span class="fu">,</span><span class="dt">"sign"</span><span class="fu">:</span><span class="dv">0</span><span class="fu">,</span><span class="dt">"interval"</span><span class="fu">:</span><span class="ot">[</span><span class="dv">0</span><span class="ot">,</span><span class="dv">5</span><span class="ot">]</span><span class="fu">,</span><span class="dt">"text"</span><span class="fu">:</span><span class="st">"Continue onto John Sims Drive"</span><span class="fu">,</span><span class="dt">"time"</span><span class="fu">:</span><span class="dv">117517</span><span class="fu">,</span><span class="dt">"street_name"</span><span class="fu">:</span><span class="st">"John Sims Drive"</span><span class="fu">}</span><span class="ot">,</span><span class="fu">{</span><span class="dt">"distance"</span><span class="fu">:</span><span class="fl">68.299</span><span class="fu">,</span><span class="dt">"sign"</span><span class="fu">:</span><span class="dv">2</span><span class="fu">,</span><span class="dt">"interval"</span><span class="fu">:</span><span class="ot">[</span><span class="dv">5</span><span class="ot">,</span><span class="dv">7</span><span class="ot">]</span><span class="fu">,</span><span class="dt">"text"</span><span class="fu">:</span><span class="st">"Turn right onto Truscott Avenue"</span><span class="fu">,</span><span class="dt">"time"</span><span class="fu">:</span><span class="dv">49175</span><span class="fu">,</span><span class="dt">"street_name"</span><span class="fu">:</span><span class="st">"Truscott Avenue"</span><span class="fu">}</span><span class="ot">,</span><span class="fu">{</span><span class="dt">"distance"</span><span class="fu">:</span><span class="fl">31.971</span><span class="fu">,</span><span class="dt">"sign"</span><span class="fu">:</span><span class="dv">1</span><span class="fu">,</span><span class="dt">"interval"</span><span class="fu">:</span><span class="ot">[</span><span class="dv">7</span><span class="ot">,</span><span class="dv">8</span><span class="ot">]</span><span class="fu">,</span><span class="dt">"text"</span><span class="fu">:</span><span class="st">"Turn slight right onto Truscott Avenue"</span><span class="fu">,</span><span class="dt">"time"</span><span class="fu">:</span><span class="dv">23019</span><span class="fu">,</span><span class="dt">"street_name"</span><span class="fu">:</span><span class="st">"Truscott Avenue"</span><span class="fu">}</span><span class="ot">,</span><span class="fu">{</span><span class="dt">"distance"</span><span class="fu">:</span><span class="fl">161.515</span><span class="fu">,</span><span class="dt">"sign"</span><span class="fu">:</span><span class="dv">2</span><span class="fu">,</span><span class="dt">"interval"</span><span class="fu">:</span><span class="ot">[</span><span class="dv">8</span><span class="ot">,</span><span class="dv">12</span><span class="ot">]</span><span class="fu">,</span><span class="dt">"text"</span><span class="fu">:</span><span class="st">"Turn right onto Elliott Street"</span><span class="fu">,</span><span class="dt">"time"</span><span class="fu">:</span><span class="dv">116290</span><span class="fu">,</span><span class="dt">"street_name"</span><span class="fu">:</span><span class="st">"Elliott Street"</span><span class="fu">}</span><span class="ot">,</span><span class="fu">{</span><span class="dt">"distance"</span><span class="fu">:</span><span class="fl">448.627</span><span class="fu">,</span><span class="dt">"sign"</span><span class="fu">:</span><span class="dv">-2</span><span class="fu">,</span><span class="dt">"interval"</span><span class="fu">:</span><span class="ot">[</span><span class="dv">12</span><span class="ot">,</span><span class="dv">18</span><span class="ot">]</span><span class="fu">,</span><span class="dt">"text"</span><span class="fu">:</span><span class="st">"Turn left onto Kipling Street"</span><span class="fu">,</span><span class="dt">"time"</span><span class="fu">:</span><span class="dv">323010</span><span class="fu">,</span><span class="dt">"street_name"</span><span class="fu">:</span><span class="st">"Kipling Street"</span><span class="fu">}</span><span class="ot">,</span><span class="fu">{</span><span class="dt">"distance"</span><span class="fu">:</span><span class="fl">133.67</span><span class="fu">,</span><span class="dt">"sign"</span><span class="fu">:</span><span class="dv">-2</span><span class="fu">,</span><span class="dt">"interval"</span><span class="fu">:</span><span class="ot">[</span><span class="dv">18</span><span class="ot">,</span><span class="dv">25</span><span class="ot">]</span><span class="fu">,</span><span class="dt">"text"</span><span class="fu">:</span><span class="st">"Turn left"</span><span class="fu">,</span><span class="dt">"time"</span><span class="fu">:</span><span class="dv">96242</span><span class="fu">,</span><span class="dt">"street_name"</span><span class="fu">:</span><span class="st">""</span><span class="fu">}</span><span class="ot">,</span><span class="fu">{</span><span class="dt">"distance"</span><span class="fu">:</span><span class="fl">0.0</span><span class="fu">,</span><span class="dt">"sign"</span><span class="fu">:</span><span class="dv">4</span><span class="fu">,</span><span class="dt">"last_heading"</span><span class="fu">:</span><span class="fl">242.3439586064843</span><span class="fu">,</span><span class="dt">"interval"</span><span class="fu">:</span><span class="ot">[</span><span class="dv">25</span><span class="ot">,</span><span class="dv">25</span><span class="ot">]</span><span class="fu">,</span><span class="dt">"text"</span><span class="fu">:</span><span class="st">"Arrive at destination"</span><span class="fu">,</span><span class="dt">"time"</span><span class="fu">:</span><span class="dv">0</span><span class="fu">,</span><span class="dt">"street_name"</span><span class="fu">:</span><span class="st">""</span><span class="fu">}</span><span class="ot">]</span><span class="fu">,</span><span class="dt">"legs"</span><span class="fu">:</span><span class="ot">[]</span><span class="fu">,</span><span class="dt">"details"</span><span class="fu">:{},</span><span class="dt">"ascend"</span><span class="fu">:</span><span class="fl">12.986007690429688</span><span class="fu">,</span><span class="dt">"descend"</span><span class="fu">:</span><span class="fl">66.6875</span><span class="fu">,</span><span class="dt">"snapped_waypoints"</span><span class="fu">:{</span><span class="dt">"type"</span><span class="fu">:</span><span class="st">"LineString"</span><span class="fu">,</span><span class="dt">"coordinates"</span><span class="fu">:</span><span class="ot">[[</span><span class="fl">174.792028</span><span class="ot">,</span><span class="fl">-41.229148</span><span class="ot">],[</span><span class="fl">174.797637</span><span class="ot">,</span><span class="fl">-41.225354</span><span class="ot">]]</span><span class="fu">}}</span><span class="ot">]</span><span class="fu">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="inverting-accessibility-to-isochrones" class="level2">
<h2 class="anchored" data-anchor-id="inverting-accessibility-to-isochrones">Inverting accessibility to isochrones</h2>
<p>Our perspective so far has been the access <em>from</em> any street location <em>to</em> the nearest park. We can flip this perspective and consider the nearest street locations <em>from</em> the park. This perspective is the basis of <em>isochrones</em>.</p>
<p>Like the accessibility analysis, we can choose the relevant units to visualise as isochrones. I’ve kept the <em>total</em> travel time units in this example.</p>
<p>The street networks below show the 0-25 minute isochrones in increments of 5 minutes. The isochrones can be visualised as convex hull polygons, or filled street skeleton isochrones. The latter visualisation has been adapted from <a href="http://kuanbutts.com/2017/12/16/osmnx-isochrones/">this excellent post</a>. The filled street skeletons offer a more realistic visualisation - especially in areas containing street networks with low connectivity like the following example.</p>
<p>The points used in the validation section are repeated here. The blue and green points represent 110 John Sims Drive and the Kipling St Play Area respectively.</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: center;">Catchment polygons</th>
<th style="text-align: center;">Catchment along streets</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><img src="output_52_0.png" class="img-fluid" alt="png"></td>
<td style="text-align: center;"><img src="output_53_0.png" class="img-fluid" alt="png"></td>
</tr>
</tbody>
</table>
<p>The isochrones are centered on the closest street node to the park. The address we’re considering is in the 20-25 minute isochrone. This corresponds well to the total time of 25 minutes calculated in the previous section (11 minutes downhill and 14 minutes uphill).</p>
<p>The isochrones visualisation is useful but we’re limited to considering a small set of parks at a time. A more insightful analysis could be to look at residential areas that fall within the catchment zones of multiple playgrounds.</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>